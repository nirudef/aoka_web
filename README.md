# üèõÔ∏è –ê–ª–º–∞—Ç–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç–Ω–∞—è –∫–æ–ª–ª–µ–≥–∏—è –∞–¥–≤–æ–∫–∞—Ç–æ–≤ (–ê–û–ö–ê)

> **–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç** ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ä–µ—Å—É—Ä—Å –¥–ª—è –≥—Ä–∞–∂–¥–∞–Ω, —é—Ä–∏—Å—Ç–æ–≤ –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π –¥–æ—Å—Ç—É–ø –∫ –ø—É–±–ª–∏–∫–∞—Ü–∏—è–º, —Ä–µ–µ—Å—Ç—Ä—É –∞–¥–≤–æ–∫–∞—Ç–æ–≤, —Ñ–∏–ª–∏–∞–ª–∞–º –∏ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–º –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è–º.

[![–ê–û–ö–ê](https://aoka.kz/wp-content/uploads/2021/10/PHOTO-2021-10-07-12-38-00.jpg)](https://aoka.kz)

---

## üîó –î–µ–º–æ –∏ —Å—Å—ã–ª–∫–∏

- **–°–∞–π—Ç**: [https://aoka.kz](https://aoka.kz)  
- **–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**: `git@github.com:nirudef/aoka_web.git`  
- **API (Rails)**: `https://api.aoka.kz`  
- **VPS (Deploy)**: `aoka-prod-01 (Almaty, Kazakhstan)`  

---

## üåê –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

| –î–ª—è –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π | –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ |
|------------------|---------------------|
| ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –Ω–æ–≤–æ—Å—Ç–µ–π, –∫–æ–Ω–∫—É—Ä—Å–æ–≤, –æ–±—ä—è–≤–ª–µ–Ω–∏–π | ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏—è–º–∏ (CRUD) |
| ‚úÖ –ü–æ–∏—Å–∫ –∞–¥–≤–æ–∫–∞—Ç–æ–≤, —Ñ–∏–ª–∏–∞–ª–æ–≤, –∫–æ–Ω—Ç–æ—Ä | ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏, —Ñ–∏–ª–∏–∞–ª–∞–º–∏, –∫–æ–Ω—Ç–æ—Ä–∞–º–∏ |
| ‚úÖ –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç—å: **—Ä—É—Å—Å–∫–∏–π**, **–∫–∞–∑–∞—Ö—Å–∫–∏–π**, **–∞–Ω–≥–ª–∏–π—Å–∫–∏–π** | ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (–∞–¥–≤–æ–∫–∞—Ç—ã, –±—É—Ö–≥–∞–ª—Ç–µ—Ä—ã, –∞–¥–º–∏–Ω—ã) |
| ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω (–º–æ–±–∏–ª—å–Ω—ã–µ/–ø–ª–∞–Ω—à–µ—Ç—ã/–¥–µ—Å–∫—Ç–æ–ø—ã) | ‚úÖ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç —Å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø—Ä–æ—Ñ–∏–ª—è |
| ‚úÖ SEO-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ, –ß–ü–£, Open Graph) | ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: Bearer-—Ç–æ–∫–µ–Ω—ã, —Å–µ—Å—Å–∏–∏ –≤ –ë–î |

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

| –£—Ä–æ–≤–µ–Ω—å | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ |
|--------|------------|
| **Frontend** | Next.js 16 (App Router), TypeScript, Tailwind CSS, `lucide-react`, `@tiptap/react` (WYSIWYG) |
| **Backend** | Ruby on Rails 8.0, PostgreSQL, `globalize`, `friendly_id`, `authentication-zero` |
| **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** | Stateless JWT-–ø–æ–¥–æ–±–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã (`signed_id`), –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ `/me` —á–µ—Ä–µ–∑ `revalidateTag` |
| **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è** | JSON-—Ñ–∞–π–ª—ã (`ru/kk/en.json`), `getTranslations`, runtime-–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ |
| **–•–æ—Å—Ç–∏–Ω–≥** | VPS (Ubuntu 24.04, Nginx, Puma), `next build && next start` |
| **CI/CD** | GitLab CI ‚Üí Deploy via SSH + `systemd` |

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

aoka-web/
‚îú‚îÄ‚îÄ app/
‚îÇ ‚îú‚îÄ‚îÄ [lang]/ # –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã (ru/kk/en)
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ articles/ # –ü—É–±–ª–∏—á–Ω—ã–µ —Å—Ç–∞—Ç—å–∏
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ cabinet/ # –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö)
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ profile/ # –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ articles/ # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏—è–º–∏ (CRUD)
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ categories/ # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ users/ # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è admin)
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ page.tsx # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ ‚îî‚îÄ‚îÄ layout.tsx # Root layout (–∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Ç–µ–º–∞)
‚îú‚îÄ‚îÄ lib/
‚îÇ ‚îú‚îÄ‚îÄ i18n/ # –°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤
‚îÇ ‚îú‚îÄ‚îÄ getcurrenuser.ts # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å /api/v1/me
‚îÇ ‚îú‚îÄ‚îÄ validation/ # –†—É—á–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –±–µ–∑ Zod
‚îÇ ‚îî‚îÄ‚îÄ types.ts # –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ç–∏–ø—ã (User, Branch, Article)
‚îú‚îÄ‚îÄ public/
‚îÇ ‚îî‚îÄ‚îÄ locales/ # JSON-–ø–µ—Ä–µ–≤–æ–¥—ã (ru.json, kk.json, en.json)
‚îî‚îÄ‚îÄ components/
‚îú‚îÄ‚îÄ CabinetSidebar.tsx # –†–æ–ª—å-–±–µ–π—Å–µ–¥ –Ω–∞–≤–∏–≥–∞—Ü–∏—è
‚îú‚îÄ‚îÄ CabinetHeader.tsx # –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏
‚îî‚îÄ‚îÄ RichTextEditor.tsx # Tiptap WYSIWYG (–±–µ–∑–æ–ø–∞—Å–Ω—ã–π, SSR-friendly)

---

## üîë –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. **–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `authentication-zero` + `Session.find_signed(token)`
- –¢–æ–∫–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `httpOnly` cookie ‚Üí –∑–∞—â–∏—â—ë–Ω –æ—Ç XSS
- `/api/v1/me` –∫—ç—à–∏—Ä—É–µ—Ç—Å—è –Ω–∞ 5 –º–∏–Ω—É—Ç —á–µ—Ä–µ–∑ `revalidateTag('user', { expire: 0 })`
- –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è ‚Äî `revalidateUser()` + `router.refresh()` ‚Üí –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

### 2. **–ú–Ω–æ–≥–æ—è–∑—ã—á–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏**
- **Articles & Categories** ‚Äî –ø–µ—Ä–µ–≤–æ–¥—ã —á–µ—Ä–µ–∑ `globalize`:
  ```ruby
  translates :title, :body, :lead, fallbacks: { 'kk' => ['kk', 'ru'] }
  ```

- –§—Ä–æ–Ω—Ç–µ–Ω–¥ ‚Äî –≤—Å–µ –ø–µ—Ä–µ–≤–æ–¥—ã –≤ public/locales/*.json, –ø–æ–¥–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ getTranslations(lang)

### 3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- getCurrentUser() ‚Üí 1 –∑–∞–ø—Ä–æ—Å/–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–Ω–µ –Ω–∞ –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç),
- fetch –¥–ª—è /api/v1/articles ‚Äî –∫—ç—à–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ next: { revalidate: 60 },
- CabinetSidebar –∏ CabinetHeader ‚Äî SSR-friendly, –Ω–µ—Ç useEffect –≤ layout.

### 4. WYSIWYG-—Ä–µ–¥–∞–∫—Ç–æ—Ä
- Tiptap (ProseMirror) ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω—ã–π, —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π, dark-mode ready,
- –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –Ω–∞ –±—ç–∫–µ–Ω–¥–µ: sanitize-html (—Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ —Ç–µ–≥–∏/–∞—Ç—Ä–∏–±—É—Ç—ã),
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞: –∂–∏—Ä–Ω—ã–π, –∫—É—Ä—Å–∏–≤, –∑–∞–≥–æ–ª–æ–≤–∫–∏, —Å–ø–∏—Å–∫–∏, —Ü–∏—Ç–∞—Ç—ã, —Ç–∞–±–ª–∏—Ü—ã, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

### 5. SEO –∏ –ß–ü–£

- Slug —á–µ—Ä–µ–∑ friendly_id —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–∏—Ä–∏–ª–ª–∏—Ü—ã:
    ```ruby
    normalize_friendly_id("–ö–æ–Ω–∫—É—Ä—Å ”ô–¥—ñ–ª “õ—ã–∑–º–µ—Ç–∫–µ—Ä–ª–µ—Ä") # ‚Üí konkurs-adil-qyzmetkerler
    ```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (–ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Node.js 18+, Ruby 3.1+, PostgreSQL 14+

#### Frontend

    ```ruby
    git clone git@github.com:nirudef/aoka_web.git
    cd web
    npm install
    cp .env.example .env.local
    npm run dev
    # ‚Üí http://localhost:3000
    ```

#### Backend (API)
- –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

    ```ruby
    bundle install
    rails db:create db:migrate db:seed
    rails s -p 3001
    # ‚Üí http://localhost:3001
    ```

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è
–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è –ê–ª–º–∞—Ç–∏–Ω—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–Ω–æ–π –∫–æ–ª–ª–µ–≥–∏–∏ –∞–¥–≤–æ–∫–∞—Ç–æ–≤.
–ö–æ–¥ –∑–∞–∫—Ä—ã—Ç—ã–π, —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ –±–µ–∑ –ø–∏—Å—å–º–µ–Ω–Ω–æ–≥–æ —Å–æ–≥–ª–∞—Å–∏—è.



This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://nextjs.org/docs/app/api-reference/cli/create-next-app).

## Getting Started

First, run the development server:

```bash
npm run dev
# or
yarn dev
# or
pnpm dev
# or
bun dev
```
